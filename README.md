# CyberSecurityProject

Github source code: https://github.com/Vil-code/CyberSecurityProject

Instructions for running the project:
First, clone the project from Github:
git clone https://github.com/Vil-code/CyberSecurityProject.git
cd CyberSecurityProject/

Then, create a virtual environment:
python3 -m venv venv
And activate the environment:
source venv/bin/activate

Make sure you have all the necessary packages installed that are in requirements.txt! (pip3 install -r requirements.txt)

Next, run the project from the root directory:
‘python3 manage.py runserver’ 
This should open the server at the following URL: http://127.0.0.1:8000/

Project Description: 

My project is a very basic social media like service where users can login and give likes to other users and write descriptions about themselves to their profile through the input field. In addition, they can see how many likes they have gotten from others and give likes by selecting another user from the drop-down menu and clicking the like button.

Below you can find three different usernames and passwords for login for three different users:

username: anna, password: alias, username: bertha, password: balias, username: kalle, password: kalias 

My security flaws are picked from the OWASP 2021 list: https://owasp.org/www-project-top-ten/. The fixes are given at the end and are marked by comments (# in python) except for number 4, which is fixed by a terminal command. 

Security Flaws List:

FLAW 1: Broken Access Control

Source in code: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/views.py#L14

It is possible to add likes to other users even thought one hasn’t logged in. For instance, we could send a GET request (I used POSTMAN to make this request, but you could technically use any service that allows making HTTP calls, even just clicking the link to open it in a browser) as follows: http://127.0.0.1:8000/like/?to=bertha . This GET call increments user Bertha’s likes by one, and the user can call this as many times as they want. This means that unauthorised users (or not even users, but complete third parties with no created user) can access behaviour that they should not have. This can be fixed by including a @login_required header before the corresponding function. 

Fix: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/views.py#L13
 FLAW 2: Cryptographic failures 

Flaw source: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/settings.py#L9 

The secret key in settings.py file is less than 50 characters long and only contains less than 5 unique characters. It has also been automatically generated by Django, hence the prefix ‘django-insecure’. The problem with this is that this secret key is used for securing signed data, in the form of generating hashes, unique session tokens and signing serialised JSON etc. If attackers could get access to it, they could for instance create this signed data by themselves and thus access unauthorised parts of the website.
The secret should be generated using a trusted cryptographic library, which contains functions to generate secret keys. For instance, using the secrets library and calling the token_urlsafe function (and deleting the old secret key afterwards). 

Fix: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/settings.py#L7

FLAW 3: Injection

Source: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/views.py#L22

It is possible to inject data to the profile description (the input field after logging in) and for instance insert an <script> </script> tag in HTML to insert javascript that can be run after loading the page again. By writing for example: <script>alert(document.cookie) </script> to the input field we can access the cookie of the user currently logged in and run other malicious javascript. 
To fix this, we need to sanitise the input on the backend before it is saved. One way of sanitising input is to use the Use html.escape() function of the html library, which converts html into string and replaces special characters by ASCII letters. This way the command does not get run but gets instead treated as a simple string.

Fix: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/views.py#L24

FLAW 4: Vulnerable and Outdated Components

Source in code: https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/requirements.txt#L2

The requirements contain outdated packages like Django that contain vulnerabilities that should be fixed.
The Django version used is 4.0.2 which contains a critical vulnerability that can lead Cross-site scripting via a debug template tag. (More precisely explained in: https://security.snyk.io/vuln/SNYK-PYTHON-DJANGO-2389002)

Fix: To fix this issue, the Django version should be patched to at least version 4.0.3 or higher. This can be done running the command ‘pip3 install django --upgrade’ from the terminal (—upgraded tries to update to the latest version).

FLAW 5: Identification and Authentication Failures

Users can try brute forcing log-in attempt as many times as they want. This means that hackers can create a script that goes through all possible combinations of passwords and tries logging in with them. If successful, they can access the private information of any user. For instance, going to the log in page and just trying out different combinations of passwords for the users does not prompt any warning. 
To fix this, we can use the Django-axes library, which locks users away after 3 times (by default). To activate this library, we need to uncomment three lines from the settings.py which allow the library to work. 

Fix (uncomment multiple parts):
1.
https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/settings.py#L27
2.
https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/settings.py#L38
3. (The four lines)
https://github.com/Vil-code/CyberSecurityProject/blob/4b5d95eff0d3ecbc0567ac5b452a424056cd9835/csproject/settings.py#L44

In case the log in screen blocks you after several failed attempts, you can clear the error by running the following: ‘python3 manage.py axes_reset’ from the terminal. 


